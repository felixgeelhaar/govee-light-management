import{i as G,d as F,u as M,a as D,b as K,r as x,c as v,w as h,o as N,e as d,f as u,g as s,h as c,j as g,v as w,k as U,l as o,m as S,t as f,n as I,F as R,p as $,q as B,_ as O,s as W,x as j,A as H}from"./propertyInspectorInit.js";function Y(){const r=G("feedbackSystem");return r?.value?{showToast:r.value.showToast,showSuccessToast:r.value.showSuccessToast,showError:r.value.showError,showWarning:r.value.showWarning,showInfo:r.value.showInfo,dismissToast:r.value.dismissToast,updateToastProgress:r.value.updateToastProgress,showGlobalLoading:r.value.showGlobalLoading,hideGlobalLoading:r.value.hideGlobalLoading,updateGlobalLoadingProgress:r.value.updateGlobalLoadingProgress,showSuccessAnimation:r.value.showSuccessAnimation}:(console.warn("Feedback system not available - ensure App.vue provides it"),{showToast:()=>"",showSuccessToast:()=>"",showError:()=>"",showWarning:()=>"",showInfo:()=>"",dismissToast:()=>{},updateToastProgress:()=>{},showGlobalLoading:()=>{},hideGlobalLoading:()=>{},updateGlobalLoadingProgress:()=>{},showSuccessAnimation:()=>{}})}function q(){const r=Y();return{...r,showApiError:(i,a="API Error")=>{const l=i?.message||"An unexpected error occurred";return r.showError(a,l,[{label:"Retry",type:"primary",action:()=>{typeof window<"u"&&window.location.reload()}}])},showValidationError:i=>r.showError("Validation Error",i),showSaveSuccess:(i="Settings")=>r.showSuccessToast(`${i} Saved`,"Your changes have been saved successfully"),showLoadingWithProgress:i=>(r.showGlobalLoading(i,0),{updateProgress:(a,l)=>{r.updateGlobalLoadingProgress(a,l)},complete:()=>{r.hideGlobalLoading()}}),showOperationSuccess:i=>{r.showSuccessAnimation(`${i} completed successfully!`)}}}const z={class:"light-control-view"},Q={class:"config-section","data-testid":"api-key-section"},J={class:"form-group"},X={class:"input-group"},Z=["disabled"],ee=["disabled"],se={key:0},te={key:1},oe={key:0,class:"status-message status-loading"},ne={key:1,class:"status-message status-success"},ie={key:2,class:"status-message status-error"},ae={class:"config-section","data-testid":"light-selection-section"},le={key:0,class:"form-group"},re=["disabled"],de={key:1,class:"status-message status-loading"},ue={key:2,class:"status-message status-error"},ce={key:3,class:"form-group"},ge={key:0,class:"search-group"},pe={class:"form-group"},ve=["disabled"],he={value:"",disabled:""},fe=["value"],me=["disabled"],ye={key:0},be={key:1},we={class:"config-section","data-testid":"control-mode-section"},Se={class:"form-group"},ke={key:0,class:"form-group"},Le={class:"range-value"},Ce={key:1,class:"form-group"},Ae={key:2,class:"form-group"},Te={class:"range-value"},Ie=F({__name:"LightControlView",setup(r){const i=M(),a=D(),l=K(),p=q(),m=x(""),y=v({get:()=>l.settings.apiKey||"",set:n=>l.updateSetting("apiKey",n||void 0)}),C=v({get:()=>{const n=l.settings.selectedDeviceId,e=l.settings.selectedModel;return n&&e?`${n}|${e}`:""},set:n=>{if(n){const[e,t]=n.split("|"),_=a.filteredLights.value.find(E=>E.value===n)?.label;l.updateSettings({selectedDeviceId:e,selectedModel:t,selectedLightName:_})}else l.updateSettings({selectedDeviceId:void 0,selectedModel:void 0,selectedLightName:void 0})}}),b=v({get:()=>l.settings.controlMode||"toggle",set:n=>l.updateSetting("controlMode",n)}),k=v({get:()=>l.settings.brightnessValue||100,set:n=>l.updateSetting("brightnessValue",n)}),A=v({get:()=>l.settings.colorValue||"#ffffff",set:n=>l.updateSetting("colorValue",n)}),L=v({get:()=>l.settings.colorTempValue||6500,set:n=>l.updateSetting("colorTempValue",n)}),T=()=>{y.value&&(p.showInfo("Connecting to API","Validating your API key..."),i.connect(y.value))},P=()=>{m.value="",a.clearSearch()};return h(()=>i.isConnected.value,(n,e)=>{n&&!e&&(p.showSuccessToast("API Connected","Successfully connected to Govee API"),a.isIdle.value&&a.fetchLights())}),h(()=>i.error.value,n=>{n&&p.showApiError({message:n},"API Connection Failed")}),h(()=>a.isReady.value,(n,e)=>{if(n&&!e&&a.hasLights.value){const t=a.lights.value.length;p.showSuccessToast("Lights Discovered",`Found ${t} light${t!==1?"s":""}`)}}),h(()=>a.error.value,n=>{n&&p.showApiError({message:n},"Light Discovery Failed")}),h(()=>l.settings.apiKey,n=>{n&&!i.isConnected.value&&i.connect(n)}),h(()=>l.lastSaved.value,n=>{n&&p.showSuccessToast("Settings Saved","Your configuration has been saved")}),N(()=>{l.enableAutoSave(500),l.loadSettings(),l.settings.apiKey&&i.connect(l.settings.apiKey)}),(n,e)=>(u(),d("div",z,[s("section",Q,[e[18]||(e[18]=s("h2",null,"API Configuration",-1)),s("div",J,[e[16]||(e[16]=s("label",{for:"apiKey"},"API Key",-1)),s("div",X,[g(s("input",{id:"apiKey","onUpdate:modelValue":e[0]||(e[0]=t=>y.value=t),type:"password",class:"form-input",placeholder:"Enter your Govee API key",autocomplete:"off",disabled:o(i).isConnecting,onKeyup:U(T,["enter"])},null,40,Z),[[w,y.value]]),o(i).isDisconnected||o(i).hasError?(u(),d("button",{key:0,class:"btn btn-primary",disabled:!y.value||o(i).isConnecting,onClick:T},[o(i).isConnecting?(u(),d("span",se,"Connecting...")):(u(),d("span",te,"Connect"))],8,ee)):o(i).isConnected?(u(),d("button",{key:1,class:"btn btn-secondary",onClick:e[1]||(e[1]=(...t)=>o(i).disconnect&&o(i).disconnect(...t))}," Disconnect ")):c("",!0)]),o(i).isConnecting?(u(),d("div",oe,e[13]||(e[13]=[s("span",{class:"status-icon"},"⏳",-1),S(" Validating API key... ",-1)]))):o(i).isConnected?(u(),d("div",ne,e[14]||(e[14]=[s("span",{class:"status-icon"},"✅",-1),S(" API key validated successfully ",-1)]))):o(i).hasError?(u(),d("div",ie,[e[15]||(e[15]=s("span",{class:"status-icon"},"❌",-1)),S(" "+f(o(i).error)+" ",1),s("button",{class:"btn-link",onClick:e[2]||(e[2]=(...t)=>o(i).retry&&o(i).retry(...t))},"Retry")])):c("",!0),e[17]||(e[17]=s("small",{class:"help-text"}," Get your API key from the Govee Home app → Settings → About Us → Apply for API Key ",-1))])]),s("section",ae,[e[23]||(e[23]=s("h2",null,"Light Selection",-1)),o(a).isIdle?(u(),d("div",le,[s("button",{class:"btn btn-primary",disabled:!o(i).isConnected,onClick:e[3]||(e[3]=(...t)=>o(a).fetchLights&&o(a).fetchLights(...t))}," Discover Lights ",8,re),e[19]||(e[19]=s("small",{class:"help-text"}," Connect your API key first, then discover available lights ",-1))])):o(a).isFetchingLights?(u(),d("div",de,e[20]||(e[20]=[s("span",{class:"status-icon"},"⏳",-1),S(" Discovering lights... ",-1)]))):o(a).hasError?(u(),d("div",ue,[e[21]||(e[21]=s("span",{class:"status-icon"},"❌",-1)),S(" "+f(o(a).error)+" ",1),s("button",{class:"btn-link",onClick:e[4]||(e[4]=(...t)=>o(a).retryFetch&&o(a).retryFetch(...t))},"Retry")])):o(a).isReady?(u(),d("div",ce,[o(a).hasLights?(u(),d("div",ge,[g(s("input",{"onUpdate:modelValue":e[5]||(e[5]=t=>m.value=t),type:"text",class:"form-input",placeholder:"Search lights...",onInput:e[6]||(e[6]=t=>o(a).searchLights(m.value))},null,544),[[w,m.value]]),m.value?(u(),d("button",{key:0,class:"btn-clear",onClick:P}," ✕ ")):c("",!0)])):c("",!0),s("div",pe,[e[22]||(e[22]=s("label",{for:"lightSelect"},"Light",-1)),g(s("select",{id:"lightSelect","onUpdate:modelValue":e[7]||(e[7]=t=>C.value=t),class:"form-select",disabled:!o(a).hasFilteredLights},[s("option",he,f(o(a).hasFilteredLights?"Select a light...":"No lights found"),1),(u(!0),d(R,null,$(o(a).filteredLights,t=>(u(),d("option",{key:t.value,value:t.value},f(t.label),9,fe))),128))],8,ve),[[I,C.value]])]),s("button",{class:"btn btn-secondary",onClick:e[8]||(e[8]=(...t)=>o(a).refreshLights&&o(a).refreshLights(...t)),disabled:o(a).isFetchingLights},[o(a).isFetchingLights?(u(),d("span",ye,"Refreshing...")):(u(),d("span",be,"Refresh Lights"))],8,me)])):c("",!0)]),s("section",we,[e[29]||(e[29]=s("h2",null,"Control Mode",-1)),s("div",Se,[e[25]||(e[25]=s("label",{for:"controlMode"},"Control Mode",-1)),g(s("select",{id:"controlMode","onUpdate:modelValue":e[9]||(e[9]=t=>b.value=t),class:"form-select"},e[24]||(e[24]=[B('<option value="toggle" data-v-da0e3522>Toggle On/Off</option><option value="on" data-v-da0e3522>Turn On</option><option value="off" data-v-da0e3522>Turn Off</option><option value="brightness" data-v-da0e3522>Set Brightness</option><option value="color" data-v-da0e3522>Set Color</option><option value="colorTemp" data-v-da0e3522>Set Color Temperature</option>',6)]),512),[[I,b.value]])]),b.value==="brightness"?(u(),d("div",ke,[e[26]||(e[26]=s("label",{for:"brightness"},"Brightness (%)",-1)),g(s("input",{id:"brightness","onUpdate:modelValue":e[10]||(e[10]=t=>k.value=t),type:"range",min:"1",max:"100",class:"form-range"},null,512),[[w,k.value,void 0,{number:!0}]]),s("span",Le,f(k.value)+"%",1)])):c("",!0),b.value==="color"?(u(),d("div",Ce,[e[27]||(e[27]=s("label",{for:"color"},"Color",-1)),g(s("input",{id:"color","onUpdate:modelValue":e[11]||(e[11]=t=>A.value=t),type:"color",class:"form-color"},null,512),[[w,A.value]])])):c("",!0),b.value==="colorTemp"?(u(),d("div",Ae,[e[28]||(e[28]=s("label",{for:"colorTemp"},"Color Temperature (K)",-1)),g(s("input",{id:"colorTemp","onUpdate:modelValue":e[12]||(e[12]=t=>L.value=t),type:"range",min:"2000",max:"9000",step:"100",class:"form-range"},null,512),[[w,L.value,void 0,{number:!0}]]),s("span",Te,f(L.value)+"K",1)])):c("",!0)])]))}}),Ve=O(Ie,[["__scopeId","data-v-da0e3522"]]);W();const V=j(H);V.component("main-view",Ve);V.mount("#app");
//# sourceMappingURL=light-control.js.map
