import{d as $,u as E,a as O,r as C,c as p,w as g,o as q,b as y,e as z,f as a,g as r,h as F,i as o,A as j,j as d,F as w,k as x,t as u,n as G,l as T,m as i,p as v,v as b,q as H,s as Q,_ as Y,x as J,y as W,z as N,B as X}from"./propertyInspectorInit.js";import{u as Z}from"./useSettings.js";import{u as ee,D as te}from"./DiagnosticsPanel.js";const se={class:"pi-view"},oe={class:"config-section diagnostics-section"},le={key:0,class:"transport-health"},ne={class:"transport-label"},ie={key:0},ae={class:"config-section","data-testid":"light-selection-section"},re={key:0,class:"form-group"},de=["disabled"],ue={key:1,class:"status-message status-loading"},ce={key:2,class:"status-message status-error"},pe={key:3,class:"form-group"},ge={key:0,class:"search-group"},ve={class:"form-group"},he=["disabled"],fe={value:"",disabled:""},me=["value"],ye=["disabled"],be={key:0},Se={key:1},Le={class:"config-section","data-testid":"control-mode-section"},ke={class:"form-group"},Ce={key:0,class:"form-group"},Te={class:"range-value"},Ve={key:1,class:"form-group"},_e={key:2,class:"form-group"},Ie={class:"range-value"},Me=$({__name:"LightControlView",setup(Fe){const c=E(),l=O(),n=Z(),h=ee(),f=C(""),V=p({get:()=>n.settings.apiKey||"",set:s=>n.updateSetting("apiKey",s||void 0)}),_=p({get:()=>{const s=n.settings.selectedDeviceId,e=n.settings.selectedModel;return s&&e?`${s}|${e}`:""},set:s=>{if(s){const[e,t]=s.split("|"),R=l.filteredLights.value.find(B=>B.value===s)?.label;n.updateSettings({selectedDeviceId:e,selectedModel:t,selectedLightName:R})}else n.updateSettings({selectedDeviceId:void 0,selectedModel:void 0,selectedLightName:void 0})}}),m=p({get:()=>n.settings.controlMode||"toggle",set:s=>n.updateSetting("controlMode",s)}),S=p({get:()=>n.settings.brightnessValue||100,set:s=>n.updateSetting("brightnessValue",s)}),I=p({get:()=>n.settings.colorValue||"#ffffff",set:s=>n.updateSetting("colorValue",s)}),L=p({get:()=>n.settings.colorTempValue||6500,set:s=>n.updateSetting("colorTempValue",s)}),k=C([]),M=C(null),U=()=>{f.value="",l.clearSearch()},D=()=>{y.requestTransportHealth()},A=()=>{y.requestTelemetrySnapshot()},P=()=>{y.resetTelemetry()},K=()=>{D(),A()};return g(()=>c.isConnected.value,(s,e)=>{s&&!e&&(h.showSuccessToast("API Connected","Successfully connected to Govee API"),l.isIdle.value&&l.fetchLights(),D(),A())}),g(()=>c.error.value,s=>{s&&h.showApiError({message:s},"API Connection Failed")}),g(()=>l.isReady.value,(s,e)=>{if(s&&!e&&l.hasLights.value){const t=l.lights.value.length;h.showSuccessToast("Lights Discovered",`Found ${t} light${t!==1?"s":""}`)}}),g(()=>l.error.value,s=>{s&&h.showApiError({message:s},"Light Discovery Failed")}),g(()=>n.settings.apiKey,s=>{s&&!c.isConnected.value&&c.connect(s)}),g(()=>n.lastSaved,s=>{s&&h.showSuccessToast("Settings Saved","Your configuration has been saved")}),q(()=>{n.enableAutoSave(500),n.loadSettings(),n.settings.apiKey&&c.connect(n.settings.apiKey);const s=e=>{e.payload?.event==="transportHealth"&&(k.value=e.payload.transports??[]),e.payload?.event==="telemetrySnapshot"&&(M.value=e.payload.snapshot??null)};y.on("sendToPropertyInspector",s),z(()=>{y.off("sendToPropertyInspector",s)})}),(s,e)=>(r(),a("div",se,[F(j,{modelValue:V.value,"onUpdate:modelValue":e[0]||(e[0]=t=>V.value=t)},null,8,["modelValue"]),o("section",oe,[e[11]||(e[11]=o("h2",null,"Connectivity Diagnostics",-1)),k.value.length?(r(),a("div",le,[o("ul",null,[(r(!0),a(w,null,x(k.value,t=>(r(),a("li",{key:t.kind},[o("span",ne,u(t.label),1),o("span",{class:G(["transport-indicator",{healthy:t.isHealthy,unhealthy:!t.isHealthy}])},[T(u(t.isHealthy?"Available":"Unavailable")+" ",1),t.latencyMs!==void 0?(r(),a("span",ie," • "+u(t.latencyMs)+" ms ",1)):d("",!0)],2)]))),128))])])):d("",!0),F(te,{snapshot:M.value,onRefresh:K,onReset:P},null,8,["snapshot"])]),o("section",ae,[e[16]||(e[16]=o("h2",null,"Light Selection",-1)),i(l).isIdle?(r(),a("div",re,[o("button",{class:"btn btn-primary",disabled:!i(c).isConnected,onClick:e[1]||(e[1]=(...t)=>i(l).fetchLights&&i(l).fetchLights(...t))}," Discover Lights ",8,de),e[12]||(e[12]=o("small",{class:"help-text"}," Connect your API key first, then discover available lights ",-1))])):i(l).isFetchingLights?(r(),a("div",ue,[...e[13]||(e[13]=[o("span",{class:"status-icon"},"⏳",-1),T(" Discovering lights... ",-1)])])):i(l).hasError?(r(),a("div",ce,[e[14]||(e[14]=o("span",{class:"status-icon"},"❌",-1)),T(" "+u(i(l).error)+" ",1),o("button",{class:"btn-link",onClick:e[2]||(e[2]=(...t)=>i(l).retryFetch&&i(l).retryFetch(...t))}," Retry ")])):i(l).isReady?(r(),a("div",pe,[i(l).hasLights?(r(),a("div",ge,[v(o("input",{"onUpdate:modelValue":e[3]||(e[3]=t=>f.value=t),type:"text",class:"form-input",placeholder:"Search lights...",onInput:e[4]||(e[4]=t=>i(l).searchLights(f.value))},null,544),[[b,f.value]]),f.value?(r(),a("button",{key:0,class:"btn-clear",onClick:U}," ✕ ")):d("",!0)])):d("",!0),o("div",ve,[e[15]||(e[15]=o("label",{for:"lightSelect"},"Light",-1)),v(o("select",{id:"lightSelect","onUpdate:modelValue":e[5]||(e[5]=t=>_.value=t),class:"form-select",disabled:!i(l).hasFilteredLights},[o("option",fe,u(i(l).hasFilteredLights?"Select a light...":"No lights found"),1),(r(!0),a(w,null,x(i(l).filteredLights.value,t=>(r(),a("option",{key:t.value,value:t.value},u(t.label),9,me))),128))],8,he),[[H,_.value]])]),o("button",{class:"btn btn-secondary",onClick:e[6]||(e[6]=(...t)=>i(l).refreshLights&&i(l).refreshLights(...t)),disabled:i(l).isFetchingLights},[i(l).isFetchingLights?(r(),a("span",be,"Refreshing...")):(r(),a("span",Se,"Refresh Lights"))],8,ye)])):d("",!0)]),o("section",Le,[e[22]||(e[22]=o("h2",null,"Control Mode",-1)),o("div",ke,[e[18]||(e[18]=o("label",{for:"controlMode"},"Control Mode",-1)),v(o("select",{id:"controlMode","onUpdate:modelValue":e[7]||(e[7]=t=>m.value=t),class:"form-select"},[...e[17]||(e[17]=[Q('<option value="toggle" data-v-039dbc9d>Toggle On/Off</option><option value="on" data-v-039dbc9d>Turn On</option><option value="off" data-v-039dbc9d>Turn Off</option><option value="brightness" data-v-039dbc9d>Set Brightness</option><option value="color" data-v-039dbc9d>Set Color</option><option value="colorTemp" data-v-039dbc9d>Set Color Temperature</option>',6)])],512),[[H,m.value]])]),m.value==="brightness"?(r(),a("div",Ce,[e[19]||(e[19]=o("label",{for:"brightness"},"Brightness (%)",-1)),v(o("input",{id:"brightness","onUpdate:modelValue":e[8]||(e[8]=t=>S.value=t),type:"range",min:"1",max:"100",class:"form-range"},null,512),[[b,S.value,void 0,{number:!0}]]),o("span",Te,u(S.value)+"%",1)])):d("",!0),m.value==="color"?(r(),a("div",Ve,[e[20]||(e[20]=o("label",{for:"color"},"Color",-1)),v(o("input",{id:"color","onUpdate:modelValue":e[9]||(e[9]=t=>I.value=t),type:"color",class:"form-color"},null,512),[[b,I.value]])])):d("",!0),m.value==="colorTemp"?(r(),a("div",_e,[e[21]||(e[21]=o("label",{for:"colorTemp"},"Color Temperature (K)",-1)),v(o("input",{id:"colorTemp","onUpdate:modelValue":e[10]||(e[10]=t=>L.value=t),type:"range",min:"2000",max:"9000",step:"100",class:"form-range"},null,512),[[b,L.value,void 0,{number:!0}]]),o("span",Ie,u(L.value)+"K",1)])):d("",!0)])]))}}),De=Y(Me,[["__scopeId","data-v-039dbc9d"]]);J();const Ae=W({render:()=>N(X,null,{default:()=>N(De)})});Ae.mount("#app");
//# sourceMappingURL=light-control.js.map
