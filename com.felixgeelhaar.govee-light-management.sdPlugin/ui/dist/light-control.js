import{d as B,u as $,a as G,b as O,c as q,r as T,e as v,w as f,o as z,f as k,g as j,h as l,i as a,j as t,k as u,l as p,v as C,m as Q,n,p as y,t as c,q as Y,F as w,s as F,x as J,D as W,y as K,z as X,_ as Z,A as ee,B as te,C as se}from"./propertyInspectorInit.js";const oe={class:"light-control-view"},ne={class:"config-section","data-testid":"api-key-section"},ie={class:"form-group"},le={class:"input-group"},ae=["disabled"],re=["disabled"],de={key:0},ue={key:1},ce={key:0,class:"status-message status-loading"},pe={key:1,class:"status-message status-success"},ge={key:2,class:"status-message status-error"},ve={class:"config-section diagnostics-section"},fe={key:0,class:"transport-health"},ye={class:"transport-label"},he={key:0},me={class:"config-section","data-testid":"light-selection-section"},be={key:0,class:"form-group"},ke=["disabled"],Ce={key:1,class:"status-message status-loading"},Se={key:2,class:"status-message status-error"},Le={key:3,class:"form-group"},Ie={key:0,class:"search-group"},Te={class:"form-group"},Ve=["disabled"],Ae={value:"",disabled:""},_e=["value"],De=["disabled"],Pe={key:0},Me={key:1},we={class:"config-section","data-testid":"control-mode-section"},Fe={class:"form-group"},Ke={key:0,class:"form-group"},xe={class:"range-value"},He={key:1,class:"form-group"},Ue={key:2,class:"form-group"},Ne={class:"range-value"},Re=B({__name:"LightControlView",setup(Be){const r=$(),i=G(),d=O(),g=q(),h=T(""),m=v({get:()=>d.settings.apiKey||"",set:o=>d.updateSetting("apiKey",o||void 0)}),V=v({get:()=>{const o=d.settings.selectedDeviceId,e=d.settings.selectedModel;return o&&e?`${o}|${e}`:""},set:o=>{if(o){const[e,s]=o.split("|"),R=i.filteredLights.value.find(E=>E.value===o)?.label;d.updateSettings({selectedDeviceId:e,selectedModel:s,selectedLightName:R})}else d.updateSettings({selectedDeviceId:void 0,selectedModel:void 0,selectedLightName:void 0})}}),b=v({get:()=>d.settings.controlMode||"toggle",set:o=>d.updateSetting("controlMode",o)}),S=v({get:()=>d.settings.brightnessValue||100,set:o=>d.updateSetting("brightnessValue",o)}),A=v({get:()=>d.settings.colorValue||"#ffffff",set:o=>d.updateSetting("colorValue",o)}),L=v({get:()=>d.settings.colorTempValue||6500,set:o=>d.updateSetting("colorTempValue",o)}),I=T([]),_=T(null),D=()=>{m.value&&(g.showInfo("Connecting to API","Validating your API key..."),r.connect(m.value))},H=()=>{h.value="",i.clearSearch()},P=()=>{k.requestTransportHealth()},M=()=>{k.requestTelemetrySnapshot()},U=()=>{k.resetTelemetry()},N=()=>{P(),M()};return f(()=>r.isConnected.value,(o,e)=>{o&&!e&&(g.showSuccessToast("API Connected","Successfully connected to Govee API"),i.isIdle.value&&i.fetchLights(),P(),M())}),f(()=>r.error.value,o=>{o&&g.showApiError({message:o},"API Connection Failed")}),f(()=>i.isReady.value,(o,e)=>{if(o&&!e&&i.hasLights.value){const s=i.lights.value.length;g.showSuccessToast("Lights Discovered",`Found ${s} light${s!==1?"s":""}`)}}),f(()=>i.error.value,o=>{o&&g.showApiError({message:o},"Light Discovery Failed")}),f(()=>d.settings.apiKey,o=>{o&&!r.isConnected.value&&r.connect(o)}),f(()=>d.lastSaved,o=>{o&&g.showSuccessToast("Settings Saved","Your configuration has been saved")}),z(()=>{d.enableAutoSave(500),d.loadSettings(),d.settings.apiKey&&r.connect(d.settings.apiKey);const o=e=>{e.payload?.event==="transportHealth"&&(I.value=e.payload.transports??[]),e.payload?.event==="telemetrySnapshot"&&(_.value=e.payload.snapshot??null)};k.on("sendToPropertyInspector",o),j(()=>{k.off("sendToPropertyInspector",o)})}),(o,e)=>(a(),l("div",oe,[t("section",ne,[e[18]||(e[18]=t("h2",null,"API Configuration",-1)),t("div",ie,[e[16]||(e[16]=t("label",{for:"apiKey"},"API Key",-1)),t("div",le,[p(t("input",{id:"apiKey","onUpdate:modelValue":e[0]||(e[0]=s=>m.value=s),type:"password",class:"form-input",placeholder:"Enter your Govee API key",autocomplete:"off",disabled:n(r).isConnecting.value,onKeyup:Q(D,["enter"])},null,40,ae),[[C,m.value]]),n(r).isDisconnected||n(r).hasError?(a(),l("button",{key:0,class:"btn btn-primary",disabled:!m.value||n(r).isConnecting.value,onClick:D},[n(r).isConnecting?(a(),l("span",de,"Connecting...")):(a(),l("span",ue,"Connect"))],8,re)):n(r).isConnected?(a(),l("button",{key:1,class:"btn btn-secondary",onClick:e[1]||(e[1]=(...s)=>n(r).disconnect&&n(r).disconnect(...s))}," Disconnect ")):u("",!0)]),n(r).isConnecting?(a(),l("div",ce,e[13]||(e[13]=[t("span",{class:"status-icon"},"⏳",-1),y(" Validating API key... ",-1)]))):n(r).isConnected?(a(),l("div",pe,e[14]||(e[14]=[t("span",{class:"status-icon"},"✅",-1),y(" API key validated successfully ",-1)]))):n(r).hasError?(a(),l("div",ge,[e[15]||(e[15]=t("span",{class:"status-icon"},"❌",-1)),y(" "+c(n(r).error)+" ",1),t("button",{class:"btn-link",onClick:e[2]||(e[2]=(...s)=>n(r).retry&&n(r).retry(...s))},"Retry")])):u("",!0),e[17]||(e[17]=t("small",{class:"help-text"}," Get your API key from the Govee Home app → Settings → About Us → Apply for API Key ",-1))])]),t("section",ve,[e[19]||(e[19]=t("h2",null,"Connectivity Diagnostics",-1)),I.value.length?(a(),l("div",fe,[t("ul",null,[(a(!0),l(w,null,F(I.value,s=>(a(),l("li",{key:s.kind},[t("span",ye,c(s.label),1),t("span",{class:J(["transport-indicator",{healthy:s.isHealthy,unhealthy:!s.isHealthy}])},[y(c(s.isHealthy?"Available":"Unavailable")+" ",1),s.latencyMs!==void 0?(a(),l("span",he," • "+c(s.latencyMs)+" ms ",1)):u("",!0)],2)]))),128))])])):u("",!0),Y(W,{snapshot:_.value,onRefresh:N,onReset:U},null,8,["snapshot"])]),t("section",me,[e[24]||(e[24]=t("h2",null,"Light Selection",-1)),n(i).isIdle?(a(),l("div",be,[t("button",{class:"btn btn-primary",disabled:!n(r).isConnected,onClick:e[3]||(e[3]=(...s)=>n(i).fetchLights&&n(i).fetchLights(...s))}," Discover Lights ",8,ke),e[20]||(e[20]=t("small",{class:"help-text"}," Connect your API key first, then discover available lights ",-1))])):n(i).isFetchingLights?(a(),l("div",Ce,e[21]||(e[21]=[t("span",{class:"status-icon"},"⏳",-1),y(" Discovering lights... ",-1)]))):n(i).hasError?(a(),l("div",Se,[e[22]||(e[22]=t("span",{class:"status-icon"},"❌",-1)),y(" "+c(n(i).error)+" ",1),t("button",{class:"btn-link",onClick:e[4]||(e[4]=(...s)=>n(i).retryFetch&&n(i).retryFetch(...s))}," Retry ")])):n(i).isReady?(a(),l("div",Le,[n(i).hasLights?(a(),l("div",Ie,[p(t("input",{"onUpdate:modelValue":e[5]||(e[5]=s=>h.value=s),type:"text",class:"form-input",placeholder:"Search lights...",onInput:e[6]||(e[6]=s=>n(i).searchLights(h.value))},null,544),[[C,h.value]]),h.value?(a(),l("button",{key:0,class:"btn-clear",onClick:H}," ✕ ")):u("",!0)])):u("",!0),t("div",Te,[e[23]||(e[23]=t("label",{for:"lightSelect"},"Light",-1)),p(t("select",{id:"lightSelect","onUpdate:modelValue":e[7]||(e[7]=s=>V.value=s),class:"form-select",disabled:!n(i).hasFilteredLights},[t("option",Ae,c(n(i).hasFilteredLights?"Select a light...":"No lights found"),1),(a(!0),l(w,null,F(n(i).filteredLights.value,s=>(a(),l("option",{key:s.value,value:s.value},c(s.label),9,_e))),128))],8,Ve),[[K,V.value]])]),t("button",{class:"btn btn-secondary",onClick:e[8]||(e[8]=(...s)=>n(i).refreshLights&&n(i).refreshLights(...s)),disabled:n(i).isFetchingLights},[n(i).isFetchingLights?(a(),l("span",Pe,"Refreshing...")):(a(),l("span",Me,"Refresh Lights"))],8,De)])):u("",!0)]),t("section",we,[e[30]||(e[30]=t("h2",null,"Control Mode",-1)),t("div",Fe,[e[26]||(e[26]=t("label",{for:"controlMode"},"Control Mode",-1)),p(t("select",{id:"controlMode","onUpdate:modelValue":e[9]||(e[9]=s=>b.value=s),class:"form-select"},e[25]||(e[25]=[X('<option value="toggle" data-v-7e7714f0>Toggle On/Off</option><option value="on" data-v-7e7714f0>Turn On</option><option value="off" data-v-7e7714f0>Turn Off</option><option value="brightness" data-v-7e7714f0>Set Brightness</option><option value="color" data-v-7e7714f0>Set Color</option><option value="colorTemp" data-v-7e7714f0>Set Color Temperature</option>',6)]),512),[[K,b.value]])]),b.value==="brightness"?(a(),l("div",Ke,[e[27]||(e[27]=t("label",{for:"brightness"},"Brightness (%)",-1)),p(t("input",{id:"brightness","onUpdate:modelValue":e[10]||(e[10]=s=>S.value=s),type:"range",min:"1",max:"100",class:"form-range"},null,512),[[C,S.value,void 0,{number:!0}]]),t("span",xe,c(S.value)+"%",1)])):u("",!0),b.value==="color"?(a(),l("div",He,[e[28]||(e[28]=t("label",{for:"color"},"Color",-1)),p(t("input",{id:"color","onUpdate:modelValue":e[11]||(e[11]=s=>A.value=s),type:"color",class:"form-color"},null,512),[[C,A.value]])])):u("",!0),b.value==="colorTemp"?(a(),l("div",Ue,[e[29]||(e[29]=t("label",{for:"colorTemp"},"Color Temperature (K)",-1)),p(t("input",{id:"colorTemp","onUpdate:modelValue":e[12]||(e[12]=s=>L.value=s),type:"range",min:"2000",max:"9000",step:"100",class:"form-range"},null,512),[[C,L.value,void 0,{number:!0}]]),t("span",Ne,c(L.value)+"K",1)])):u("",!0)])]))}}),Ee=Z(Re,[["__scopeId","data-v-7e7714f0"]]);ee();const x=te(se);x.component("main-view",Ee);x.mount("#app");
//# sourceMappingURL=light-control.js.map
